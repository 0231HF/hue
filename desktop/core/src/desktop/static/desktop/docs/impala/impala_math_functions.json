{"body":"<div><p>\n      Mathematical functions, or arithmetic functions, perform numeric calculations that are typically more complex\n      than basic addition, subtraction, multiplication, and division. For example, these functions include\n      trigonometric, logarithmic, and base conversion operations.\n    </p><div class=\"sql-docs-note\">\n      In Impala, exponentiation uses the <span class=\"sql-docs-inline-code\">pow()</span> function rather than an exponentiation operator\n      such as <span class=\"sql-docs-inline-code\">**</span>.\n    </div><p id=\"../Impala/docs/topics/impala_math_functions.xml_related_info\"><b>Related information:</b></p><p>\n      The mathematical functions operate mainly on these data types: <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_int.xml#int\">INT Data Type</a>,\n      <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_bigint.xml#bigint\">BIGINT Data Type</a>, <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_smallint.xml#smallint\">SMALLINT Data Type</a>,\n      <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_tinyint.xml#tinyint\">TINYINT Data Type</a>, <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_double.xml#double\">DOUBLE Data Type</a>,\n      <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_float.xml#float\">FLOAT Data Type</a>, and <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_decimal.xml#decimal\">DECIMAL Data Type (Impala 1.4 or higher only)</a>. For the operators that\n      perform the standard operations such as addition, subtraction, multiplication, and division, see\n      <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_operators.xml#arithmetic_operators\"><h4>Arithmetic Operators</h4></a>.\n    </p><p>\n      Functions that perform bitwise operations are explained in <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_bit_functions.xml#bit_functions\">Impala Bit Functions</a>.\n    </p><p><b>Function reference:</b></p><p>\n      Impala supports the following mathematical functions:\n    </p><dl><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_abs\"><dt><span class=\"sql-docs-inline-code\">abs(numeric_type a)</span></dt><dd><b>Purpose:</b> Returns the absolute value of the argument.\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_return_type_same\"><b>Return type:</b> Same as the input value\n      </p><p><b>Usage notes:</b> Use this function to ensure all return values are positive. This is different than\n            the <span class=\"sql-docs-inline-code\">positive()</span> function, which returns its argument unchanged (even if the argument\n            was negative).\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_acos\"><dt><span class=\"sql-docs-inline-code\">acos(double a)</span></dt><dd><b>Purpose:</b> Returns the arccosine of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_asin\"><dt><span class=\"sql-docs-inline-code\">asin(double a)</span></dt><dd><b>Purpose:</b> Returns the arcsine of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_atan\"><dt><span class=\"sql-docs-inline-code\">atan(double a)</span></dt><dd><b>Purpose:</b> Returns the arctangent of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_atan2\"><dt><span class=\"sql-docs-inline-code\">atan2(double a, double b)</span></dt><dd><b>Purpose:</b> Returns the arctangent of the two arguments, with the signs of the arguments used to determine the\n          quadrant of the result.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_bin\"><dt><span class=\"sql-docs-inline-code\">bin(bigint a)</span></dt><dd><b>Purpose:</b> Returns the binary representation of an integer value, that is, a string of 0 and 1\n          digits.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">string</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_ceil\"><dt><span class=\"sql-docs-inline-code\">ceil(double a)</span>,\n          <span class=\"sql-docs-inline-code\">ceil(decimal(p,s) a)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_ceiling\" class=\"sql-docs-inline-code\">ceiling(double a)</span>,\n          <span class=\"sql-docs-inline-code\">ceiling(decimal(p,s) a)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dceil\" class=\"sql-docs-inline-code\">dceil(double a)</span>,\n          <span class=\"sql-docs-inline-code\">dceil(decimal(p,s) a)</span></dt><dd><b>Purpose:</b> Returns the smallest integer that is greater than or equal to the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">int</span> or <span class=\"sql-docs-inline-code\">decimal(p,s)</span> depending on the type of the\n            input argument\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_conv\"><dt><span class=\"sql-docs-inline-code\">conv(bigint num, int from_base, int to_base), conv(string num, int from_base, int\n          to_base)</span></dt><dd><b>Purpose:</b> Returns a string representation of an integer value in a particular base. The input value\n          can be a string, for example to convert a hexadecimal number such as <span class=\"sql-docs-inline-code\">fce2</span> to decimal. To\n          use the return value as a number (for example, when converting to base 10), use <span class=\"sql-docs-inline-code\">CAST()</span>\n          to convert to the appropriate type.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">string</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_cos\"><dt><span class=\"sql-docs-inline-code\">cos(double a)</span></dt><dd><b>Purpose:</b> Returns the cosine of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_cosh\"><dt><span class=\"sql-docs-inline-code\">cosh(double a)</span></dt><dd><b>Purpose:</b> Returns the hyperbolic cosine of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_cot\"><dt><span class=\"sql-docs-inline-code\">cot(double a)</span></dt><dd><b>Purpose:</b> Returns the cotangent of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_added_in_230\"><b>Added in:</b>Impala 2.3.0</p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_degrees\"><dt><span class=\"sql-docs-inline-code\">degrees(double a)</span></dt><dd><b>Purpose:</b> Converts argument value from radians to degrees.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_e\"><dt><span class=\"sql-docs-inline-code\">e()</span></dt><dd><b>Purpose:</b> Returns the\n          <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/E_(mathematical_constant\">mathematical\n          constant e</a>.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_exp\"><dt><span class=\"sql-docs-inline-code\">exp(double a)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dexp\" class=\"sql-docs-inline-code\">dexp(double a)</span></dt><dd><b>Purpose:</b> Returns the\n          <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/E_(mathematical_constant\">mathematical\n          constant e</a> raised to the power of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_factorial\"><dt><span class=\"sql-docs-inline-code\">factorial(integer_type a)</span></dt><dd><b>Purpose:</b> Computes the <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Factorial\">factorial</a> of an integer value.\n          It works with any integer type.\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_added_in_230\"><b>Added in:</b>Impala 2.3.0</p><p><b>Usage notes:</b> You can use either the <span class=\"sql-docs-inline-code\">factorial()</span> function or the <span class=\"sql-docs-inline-code\">!</span> operator.\n            The factorial of 0 is 1. Likewise, the <span class=\"sql-docs-inline-code\">factorial()</span> function returns 1 for any negative value.\n            The maximum positive value for the input argument is 20; a value of 21 or greater overflows the\n            range for a <span class=\"sql-docs-inline-code\">BIGINT</span> and causes an error.\n          </p><p><b>Return type:</b><span class=\"sql-docs-inline-code\">bigint</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_added_in_230\"><b>Added in:</b>Impala 2.3.0</p><div class=\"sql-docs-code-block\">select factorial(5);<br/>+--------------+<br/>| factorial(5) |<br/>+--------------+<br/>| 120          |<br/>+--------------+<br/><br/>select 5!;<br/>+-----+<br/>| 5!  |<br/>+-----+<br/>| 120 |<br/>+-----+<br/><br/>select factorial(0);<br/>+--------------+<br/>| factorial(0) |<br/>+--------------+<br/>| 1            |<br/>+--------------+<br/><br/>select factorial(-100);<br/>+-----------------+<br/>| factorial(-100) |<br/>+-----------------+<br/>| 1               |<br/>+-----------------+<br/></div></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_floor\"><dt><span class=\"sql-docs-inline-code\">floor(double a)</span>,\n          <span class=\"sql-docs-inline-code\">floor(decimal(p,s) a)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dfloor\" class=\"sql-docs-inline-code\">dfloor(double a)</span>,\n          <span class=\"sql-docs-inline-code\">dfloor(decimal(p,s) a)</span></dt><dd><b>Purpose:</b> Returns the largest integer that is less than or equal to the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">bigint</span> or <span class=\"sql-docs-inline-code\">decimal(p,s)</span> depending on the type of\n            the input argument\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_fmod\"><dt><span class=\"sql-docs-inline-code\">fmod(double a, double b), fmod(float a, float b)</span></dt><dd><b>Purpose:</b> Returns the modulus of a floating-point number. Equivalent to the <span class=\"sql-docs-inline-code\">%</span> arithmetic operator.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">float</span> or <span class=\"sql-docs-inline-code\">double</span>, depending on type of arguments\n          </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_added_in_111\"><b>Added in:</b> Impala 1.1.1\n      </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p>\n            Because this function operates on <span class=\"sql-docs-inline-code\">DOUBLE</span> or <span class=\"sql-docs-inline-code\">FLOAT</span>\n            values, it is subject to potential rounding errors for values that cannot be\n            represented precisely. Prefer to use whole numbers, or values that you know\n            can be represented precisely by the <span class=\"sql-docs-inline-code\">DOUBLE</span> or <span class=\"sql-docs-inline-code\">FLOAT</span>\n            types.\n          </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><p>\n            The following examples show equivalent operations with the <span class=\"sql-docs-inline-code\">fmod()</span>\n            function and the <span class=\"sql-docs-inline-code\">%</span> arithmetic operator, for values not subject\n            to any rounding error.\n          </p><div class=\"sql-docs-code-block\">select fmod(10,3);<br/>+-------------+<br/>| fmod(10, 3) |<br/>+-------------+<br/>| 1           |<br/>+-------------+<br/><br/>select fmod(5.5,2);<br/>+--------------+<br/>| fmod(5.5, 2) |<br/>+--------------+<br/>| 1.5          |<br/>+--------------+<br/><br/>select 10 % 3;<br/>+--------+<br/>| 10 % 3 |<br/>+--------+<br/>| 1      |<br/>+--------+<br/><br/>select 5.5 % 2;<br/>+---------+<br/>| 5.5 % 2 |<br/>+---------+<br/>| 1.5     |<br/>+---------+<br/></div><p>\n            The following examples show operations with the <span class=\"sql-docs-inline-code\">fmod()</span>\n            function for values that cannot be represented precisely by the\n            <span class=\"sql-docs-inline-code\">DOUBLE</span> or <span class=\"sql-docs-inline-code\">FLOAT</span> types, and thus are\n            subject to rounding error. <span class=\"sql-docs-inline-code\">fmod(9.9,3.0)</span> returns a value\n            slightly different than the expected 0.9 because of rounding.\n            <span class=\"sql-docs-inline-code\">fmod(9.9,3.3)</span> returns a value quite different from\n            the expected value of 0 because of rounding error during intermediate\n            calculations.\n          </p><div class=\"sql-docs-code-block\">select fmod(9.9,3.0);<br/>+--------------------+<br/>| fmod(9.9, 3.0)     |<br/>+--------------------+<br/>| 0.8999996185302734 |<br/>+--------------------+<br/><br/>select fmod(9.9,3.3);<br/>+-------------------+<br/>| fmod(9.9, 3.3)    |<br/>+-------------------+<br/>| 3.299999713897705 |<br/>+-------------------+<br/></div></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_fnv_hash\"><dt><span class=\"sql-docs-inline-code\">fnv_hash(type v)</span>,\n        </dt><dd><b>Purpose:</b> Returns a consistent 64-bit value derived from the input argument, for convenience of\n          implementing hashing logic in an application.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">BIGINT</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p>\n            You might use the return value in an application where you perform load balancing, bucketing, or some\n            other technique to divide processing or storage.\n          </p><p>\n            Because the result can be any 64-bit value, to restrict the value to a particular range, you can use an\n            expression that includes the <span class=\"sql-docs-inline-code\">ABS()</span> function and the <span class=\"sql-docs-inline-code\">%</span> (modulo)\n            operator. For example, to produce a hash value in the range 0-9, you could use the expression\n            <span class=\"sql-docs-inline-code\">ABS(FNV_HASH(x)) % 10</span>.\n          </p><p>\n            This function implements the same algorithm that Impala uses internally for hashing, on systems where\n            the CRC32 instructions are not available.\n          </p><p>\n            This function implements the\n            <a target=\"_blank\" href=\"http://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\">Fowler–Noll–Vo\n            hash function</a>, in particular the FNV-1a variation. This is not a perfect hash function: some\n            combinations of values could produce the same result value. It is not suitable for cryptographic use.\n          </p><p>\n            Similar input values of different types could produce different hash values, for example the same\n            numeric value represented as <span class=\"sql-docs-inline-code\">SMALLINT</span> or <span class=\"sql-docs-inline-code\">BIGINT</span>,\n            <span class=\"sql-docs-inline-code\">FLOAT</span> or <span class=\"sql-docs-inline-code\">DOUBLE</span>, or <span class=\"sql-docs-inline-code\">DECIMAL(5,2)</span> or\n            <span class=\"sql-docs-inline-code\">DECIMAL(20,5)</span>.\n          </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><div class=\"sql-docs-code-block\">[localhost:21000] > create table h (x int, s string);<br/>[localhost:21000] > insert into h values (0, 'hello'), (1,'world'), (1234567890,'antidisestablishmentarianism');<br/>[localhost:21000] > select x, fnv_hash(x) from h;<br/>+------------+----------------------+<br/>| x          | fnv_hash(x)          |<br/>+------------+----------------------+<br/>| 0          | -2611523532599129963 |<br/>| 1          | 4307505193096137732  |<br/>| 1234567890 | 3614724209955230832  |<br/>+------------+----------------------+<br/>[localhost:21000] > select s, fnv_hash(s) from h;<br/>+------------------------------+---------------------+<br/>| s                            | fnv_hash(s)         |<br/>+------------------------------+---------------------+<br/>| hello                        | 6414202926103426347 |<br/>| world                        | 6535280128821139475 |<br/>| antidisestablishmentarianism | -209330013948433970 |<br/>+------------------------------+---------------------+<br/>[localhost:21000] > select s, abs(fnv_hash(s)) % 10 from h;<br/>+------------------------------+-------------------------+<br/>| s                            | abs(fnv_hash(s)) % 10.0 |<br/>+------------------------------+-------------------------+<br/>| hello                        | 8                       |<br/>| world                        | 6                       |<br/>| antidisestablishmentarianism | 4                       |<br/>+------------------------------+-------------------------+</div><p>\n            For short argument values, the high-order bits of the result have relatively low entropy:\n          </p><div class=\"sql-docs-code-block\">[localhost:21000] > create table b (x boolean);<br/>[localhost:21000] > insert into b values (true), (true), (false), (false);<br/>[localhost:21000] > select x, fnv_hash(x) from b;<br/>+-------+---------------------+<br/>| x     | fnv_hash(x)         |<br/>+-------+---------------------+<br/>| true  | 2062020650953872396 |<br/>| true  | 2062020650953872396 |<br/>| false | 2062021750465500607 |<br/>| false | 2062021750465500607 |<br/>+-------+---------------------+</div><p><b>Added in:</b> Impala 1.2.2\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_greatest\"><dt><span class=\"sql-docs-inline-code\">greatest(bigint a[, bigint b ...])</span>, <span class=\"sql-docs-inline-code\">greatest(double a[, double b ...])</span>,\n          <span class=\"sql-docs-inline-code\">greatest(decimal(p,s) a[, decimal(p,s) b ...])</span>, <span class=\"sql-docs-inline-code\">greatest(string a[, string b\n          ...])</span>, <span class=\"sql-docs-inline-code\">greatest(timestamp a[, timestamp b ...])</span></dt><dd><b>Purpose:</b> Returns the largest value from a list of expressions.\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_return_same_type\"><b>Return type:</b> same as the initial argument value, except that integer values are promoted to\n        <span class=\"sql-docs-inline-code\">BIGINT</span> and floating-point values are promoted to <span class=\"sql-docs-inline-code\">DOUBLE</span>; use\n        <span class=\"sql-docs-inline-code\">CAST()</span> when inserting into a smaller numeric column\n      </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_hex\"><dt><span class=\"sql-docs-inline-code\">hex(bigint a), hex(string a)</span></dt><dd><b>Purpose:</b> Returns the hexadecimal representation of an integer value, or of the characters in a\n          string.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">string</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_is_inf\"><dt><span class=\"sql-docs-inline-code\">is_inf(double a)</span>,\n        </dt><dd><b>Purpose:</b> Tests whether a value is equal to the special value <q>inf</q>, signifying infinity.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">boolean</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_infinity_and_nan\">\n        Infinity and NaN can be specified in text data files as <span class=\"sql-docs-inline-code\">inf</span> and <span class=\"sql-docs-inline-code\">nan</span>\n        respectively, and Impala interprets them as these special values. They can also be produced by certain\n        arithmetic expressions; for example, <span class=\"sql-docs-inline-code\">1/0</span> returns <span class=\"sql-docs-inline-code\">Infinity</span> and\n        <span class=\"sql-docs-inline-code\">pow(-1, 0.5)</span> returns <span class=\"sql-docs-inline-code\">NaN</span>. Or you can cast the literal values, such as <span class=\"sql-docs-inline-code\">CAST('nan' AS\n        DOUBLE)</span> or <span class=\"sql-docs-inline-code\">CAST('inf' AS DOUBLE)</span>.\n      </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_is_nan\"><dt><span class=\"sql-docs-inline-code\">is_nan(double a)</span>,\n        </dt><dd><b>Purpose:</b> Tests whether a value is equal to the special value <q>NaN</q>, signifying <q>not a\n          number</q>.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">boolean</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_infinity_and_nan\">\n        Infinity and NaN can be specified in text data files as <span class=\"sql-docs-inline-code\">inf</span> and <span class=\"sql-docs-inline-code\">nan</span>\n        respectively, and Impala interprets them as these special values. They can also be produced by certain\n        arithmetic expressions; for example, <span class=\"sql-docs-inline-code\">1/0</span> returns <span class=\"sql-docs-inline-code\">Infinity</span> and\n        <span class=\"sql-docs-inline-code\">pow(-1, 0.5)</span> returns <span class=\"sql-docs-inline-code\">NaN</span>. Or you can cast the literal values, such as <span class=\"sql-docs-inline-code\">CAST('nan' AS\n        DOUBLE)</span> or <span class=\"sql-docs-inline-code\">CAST('inf' AS DOUBLE)</span>.\n      </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_least\"><dt><span class=\"sql-docs-inline-code\">least(bigint a[, bigint b ...])</span>, <span class=\"sql-docs-inline-code\">least(double a[, double b ...])</span>,\n          <span class=\"sql-docs-inline-code\">least(decimal(p,s) a[, decimal(p,s) b ...])</span>, <span class=\"sql-docs-inline-code\">least(string a[, string b\n          ...])</span>, <span class=\"sql-docs-inline-code\">least(timestamp a[, timestamp b ...])</span></dt><dd><b>Purpose:</b> Returns the smallest value from a list of expressions.\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_return_same_type\"><b>Return type:</b> same as the initial argument value, except that integer values are promoted to\n        <span class=\"sql-docs-inline-code\">BIGINT</span> and floating-point values are promoted to <span class=\"sql-docs-inline-code\">DOUBLE</span>; use\n        <span class=\"sql-docs-inline-code\">CAST()</span> when inserting into a smaller numeric column\n      </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_ln\"><dt><span class=\"sql-docs-inline-code\">ln(double a)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dlog1\" class=\"sql-docs-inline-code\">dlog1(double a)</span></dt><dd><b>Purpose:</b> Returns the\n          <a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Natural_logarithm\">natural\n          logarithm</a> of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_log\"><dt><span class=\"sql-docs-inline-code\">log(double base, double a)</span></dt><dd><b>Purpose:</b> Returns the logarithm of the second argument to the specified base.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_log10\"><dt><span class=\"sql-docs-inline-code\">log10(double a)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dlog10\" class=\"sql-docs-inline-code\">dlog10(double a)</span></dt><dd><b>Purpose:</b> Returns the logarithm of the argument to the base 10.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_log2\"><dt><span class=\"sql-docs-inline-code\">log2(double a)</span></dt><dd><b>Purpose:</b> Returns the logarithm of the argument to the base 2.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_max_int\"><dt><span class=\"sql-docs-inline-code\">max_int(), <span id=\"../Impala/docs/topics/impala_math_functions.xml_max_tinyint\" class=\"sql-docs-inline-code\">max_tinyint()</span>, <span id=\"../Impala/docs/topics/impala_math_functions.xml_max_smallint\" class=\"sql-docs-inline-code\">max_smallint()</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_max_bigint\" class=\"sql-docs-inline-code\">max_bigint()</span></span></dt><dd><b>Purpose:</b> Returns the largest value of the associated integral type.\n          <p><b>Return type:</b> The same as the integral type being checked.\n          </p><p><b>Usage notes:</b> Use the corresponding <span class=\"sql-docs-inline-code\">min_</span> and <span class=\"sql-docs-inline-code\">max_</span> functions to\n            check if all values in a column are within the allowed range, before copying data or altering column\n            definitions. If not, switch to the next higher integral type or to a <span class=\"sql-docs-inline-code\">DECIMAL</span> with\n            sufficient precision.\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_min_int\"><dt><span class=\"sql-docs-inline-code\">min_int(), <span id=\"../Impala/docs/topics/impala_math_functions.xml_min_tinyint\" class=\"sql-docs-inline-code\">min_tinyint()</span>, <span id=\"../Impala/docs/topics/impala_math_functions.xml_min_smallint\" class=\"sql-docs-inline-code\">min_smallint()</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_min_bigint\" class=\"sql-docs-inline-code\">min_bigint()</span></span></dt><dd><b>Purpose:</b> Returns the smallest value of the associated integral type (a negative number).\n          <p><b>Return type:</b> The same as the integral type being checked.\n          </p><p><b>Usage notes:</b> Use the corresponding <span class=\"sql-docs-inline-code\">min_</span> and <span class=\"sql-docs-inline-code\">max_</span> functions to\n            check if all values in a column are within the allowed range, before copying data or altering column\n            definitions. If not, switch to the next higher integral type or to a <span class=\"sql-docs-inline-code\">DECIMAL</span> with\n            sufficient precision.\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_mod\"><dt><span class=\"sql-docs-inline-code\">mod(<span class=\"sql-docs-variable\">numeric_type</span> a, <span class=\"sql-docs-variable\">same_type</span> b)</span></dt><dd><b>Purpose:</b> Returns the modulus of a number. Equivalent to the <span class=\"sql-docs-inline-code\">%</span> arithmetic operator.\n          Works with any size integer type, any size floating-point type, and <span class=\"sql-docs-inline-code\">DECIMAL</span>\n          with any precision and scale.\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_return_type_same\"><b>Return type:</b> Same as the input value\n      </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_added_in_220\"><b>Added in:</b>Impala 2.2.0</p><p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p>\n            Because this function works with <span class=\"sql-docs-inline-code\">DECIMAL</span> values, prefer it over <span class=\"sql-docs-inline-code\">fmod()</span>\n            when working with fractional values. It is not subject to the rounding errors that make\n            <span class=\"sql-docs-inline-code\">fmod()</span> problematic with floating-point numbers.\n            The <span class=\"sql-docs-inline-code\">%</span> arithmetic operator now uses the <span class=\"sql-docs-inline-code\">mod()</span> function\n            in cases where its arguments can be interpreted as <span class=\"sql-docs-inline-code\">DECIMAL</span> values,\n            increasing the accuracy of that operator.\n          </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><p>\n            The following examples show how the <span class=\"sql-docs-inline-code\">mod()</span> function works for\n            whole numbers and fractional values, and how the <span class=\"sql-docs-inline-code\">%</span> operator\n            works the same way. In the case of <span class=\"sql-docs-inline-code\">mod(9.9,3)</span>,\n            the type conversion for the second argument results in the first argument\n            being interpreted as <span class=\"sql-docs-inline-code\">DOUBLE</span>, so to produce an accurate\n            <span class=\"sql-docs-inline-code\">DECIMAL</span> result requires casting the second argument\n            or writing it as a <span class=\"sql-docs-inline-code\">DECIMAL</span> literal, 3.0.\n          </p><div class=\"sql-docs-code-block\">select mod(10,3);<br/>+-------------+<br/>| fmod(10, 3) |<br/>+-------------+<br/>| 1           |<br/>+-------------+<br/><br/>select mod(5.5,2);<br/>+--------------+<br/>| fmod(5.5, 2) |<br/>+--------------+<br/>| 1.5          |<br/>+--------------+<br/><br/>select 10 % 3;<br/>+--------+<br/>| 10 % 3 |<br/>+--------+<br/>| 1      |<br/>+--------+<br/><br/>select 5.5 % 2;<br/>+---------+<br/>| 5.5 % 2 |<br/>+---------+<br/>| 1.5     |<br/>+---------+<br/><br/>select mod(9.9,3.3);<br/>+---------------+<br/>| mod(9.9, 3.3) |<br/>+---------------+<br/>| 0.0           |<br/>+---------------+<br/><br/>select mod(9.9,3);<br/>+--------------------+<br/>| mod(9.9, 3)        |<br/>+--------------------+<br/>| 0.8999996185302734 |<br/>+--------------------+<br/><br/>select mod(9.9, cast(3 as decimal(2,1)));<br/>+-----------------------------------+<br/>| mod(9.9, cast(3 as decimal(2,1))) |<br/>+-----------------------------------+<br/>| 0.9                               |<br/>+-----------------------------------+<br/><br/>select mod(9.9,3.0);<br/>+---------------+<br/>| mod(9.9, 3.0) |<br/>+---------------+<br/>| 0.9           |<br/>+---------------+<br/></div></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_murmur_hash\"><dt><span class=\"sql-docs-inline-code\">murmur_hash(type v)</span></dt><dd><b>Purpose:</b> Returns a consistent 64-bit value derived from the input argument, for convenience of\n          implementing  non-cryptographic hash function.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">BIGINT</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p>\n            You might use the return value in an application where you perform load balancing, bucketing, or some\n            other technique to divide processing or storage. This function provides a good performance for all kinds\n            of keys such as number, ascii string and UTF-8. It can be recommended as general-purpose hashing function.\n          </p><p>\n            Regarding comparison of murmur_hash with fnv_hash, murmur_hash is based on Murmur2 hash algorithm and fnv_hash\n            function is based on FNV-1a hash algorithm. Murmur2 and FNV-1a can show very good randomness and performance\n            compared with well known other hash algorithms, but Murmur2 slightly show better randomness and performance than FNV-1a.\n            See  for details.\n          </p><p>\n            Similar input values of different types could produce different hash values, for example the same\n            numeric value represented as <span class=\"sql-docs-inline-code\">SMALLINT</span> or <span class=\"sql-docs-inline-code\">BIGINT</span>,\n            <span class=\"sql-docs-inline-code\">FLOAT</span> or <span class=\"sql-docs-inline-code\">DOUBLE</span>, or <span class=\"sql-docs-inline-code\">DECIMAL(5,2)</span> or\n            <span class=\"sql-docs-inline-code\">DECIMAL(20,5)</span>.\n          </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><div class=\"sql-docs-code-block\">[localhost:21000] > create table h (x int, s string);<br/>[localhost:21000] > insert into h values (0, 'hello'), (1,'world'), (1234567890,'antidisestablishmentarianism');<br/>[localhost:21000] > select x, murmur_hash(x) from h;<br/>+------------+----------------------+<br/>| x          | murmur_hash(x)       |<br/>+------------+----------------------+<br/>| 0          | 6960269033020761575  |<br/>| 1          | -780611581681153783  |<br/>| 1234567890 | -5754914572385924334 |<br/>+------------+----------------------+<br/>[localhost:21000] > select s, murmur_hash(s) from h;<br/>+------------------------------+----------------------+<br/>| s                            | murmur_hash(s)       |<br/>+------------------------------+----------------------+<br/>| hello                        | 2191231550387646743  |<br/>| world                        | 5568329560871645431  |<br/>| antidisestablishmentarianism | -2261804666958489663 |<br/>+------------------------------+----------------------+ </div><p>\n            For short argument values, the high-order bits of the result have relatively higher entropy than fnv_hash:\n          </p><div class=\"sql-docs-code-block\">[localhost:21000] > create table b (x boolean);<br/>[localhost:21000] > insert into b values (true), (true), (false), (false);<br/>[localhost:21000] > select x, murmur_hash(x) from b;<br/>+-------+----------------------+<br/>| x     | murmur_hash(x)       |<br/>+-------+---------------------++<br/>| true  | -5720937396023583481 |<br/>| true  | -5720937396023583481 |<br/>| false | 6351753276682545529  |<br/>| false | 6351753276682545529  |<br/>+-------+--------------------+-+</div><p><b>Added in:</b> Impala 2.12.0\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_negative\"><dt><span class=\"sql-docs-inline-code\">negative(numeric_type a)</span></dt><dd><b>Purpose:</b> Returns the argument with the sign reversed; returns a positive value if the argument was\n          already negative.\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_return_type_same\"><b>Return type:</b> Same as the input value\n      </p><p><b>Usage notes:</b> Use <span class=\"sql-docs-inline-code\">-abs(a)</span> instead if you need to ensure all return values are\n            negative.\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_pi\"><dt><span class=\"sql-docs-inline-code\">pi()</span></dt><dd><b>Purpose:</b> Returns the constant pi.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_pmod\"><dt><span class=\"sql-docs-inline-code\">pmod(bigint a, bigint b), pmod(double a, double b)</span></dt><dd><b>Purpose:</b> Returns the positive modulus of a number.\n          Primarily for <a target=\"_blank\" href=\"https://issues.apache.org/jira/browse/HIVE-656\">HiveQL compatibility</a>.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">int</span> or <span class=\"sql-docs-inline-code\">double</span>, depending on type of arguments\n          </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><p>\n            The following examples show how the <span class=\"sql-docs-inline-code\">fmod()</span> function sometimes returns a negative value\n            depending on the sign of its arguments, and the <span class=\"sql-docs-inline-code\">pmod()</span> function returns the same value\n            as <span class=\"sql-docs-inline-code\">fmod()</span>, but sometimes with the sign flipped.\n          </p><div class=\"sql-docs-code-block\">select fmod(-5,2);<br/>+-------------+<br/>| fmod(-5, 2) |<br/>+-------------+<br/>| -1          |<br/>+-------------+<br/><br/>select pmod(-5,2);<br/>+-------------+<br/>| pmod(-5, 2) |<br/>+-------------+<br/>| 1           |<br/>+-------------+<br/><br/>select fmod(-5,-2);<br/>+--------------+<br/>| fmod(-5, -2) |<br/>+--------------+<br/>| -1           |<br/>+--------------+<br/><br/>select pmod(-5,-2);<br/>+--------------+<br/>| pmod(-5, -2) |<br/>+--------------+<br/>| -1           |<br/>+--------------+<br/><br/>select fmod(5,-2);<br/>+-------------+<br/>| fmod(5, -2) |<br/>+-------------+<br/>| 1           |<br/>+-------------+<br/><br/>select pmod(5,-2);<br/>+-------------+<br/>| pmod(5, -2) |<br/>+-------------+<br/>| -1          |<br/>+-------------+<br/></div></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_positive\"><dt><span class=\"sql-docs-inline-code\">positive(numeric_type a)</span></dt><dd><b>Purpose:</b> Returns the original argument unchanged (even if the argument is negative).\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_return_type_same\"><b>Return type:</b> Same as the input value\n      </p><p><b>Usage notes:</b> Use <span class=\"sql-docs-inline-code\">abs()</span> instead if you need to ensure all return values are\n            positive.\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_pow\"><dt><span class=\"sql-docs-inline-code\">pow(double a, double p)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_power\" class=\"sql-docs-inline-code\">power(double a, double p)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dpow\" class=\"sql-docs-inline-code\">dpow(double a, double p)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_fpow\" class=\"sql-docs-inline-code\">fpow(double a, double p)</span></dt><dd><b>Purpose:</b> Returns the first argument raised to the power of the second argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_precision\"><dt><span class=\"sql-docs-inline-code\">precision(<span class=\"sql-docs-variable\">numeric_expression</span>)</span></dt><dd><b>Purpose:</b> Computes the precision (number of decimal digits) needed to represent the type of the\n          argument expression as a <span class=\"sql-docs-inline-code\">DECIMAL</span> value.\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p>\n            Typically used in combination with the <span class=\"sql-docs-inline-code\">scale()</span> function, to determine the appropriate\n            <span class=\"sql-docs-inline-code\">DECIMAL(<span class=\"sql-docs-variable\">precision</span>,<span class=\"sql-docs-variable\">scale</span>)</span> type to declare in a\n            <span class=\"sql-docs-inline-code\">CREATE TABLE</span> statement or <span class=\"sql-docs-inline-code\">CAST()</span> function.\n          </p><p><b>Return type:</b><span class=\"sql-docs-inline-code\">int</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_precision_scale_example\">\n        The following examples demonstrate how to check the precision and scale of numeric literals or other\n        numeric expressions. Impala represents numeric literals in the smallest appropriate type. 5 is a\n        <span class=\"sql-docs-inline-code\">TINYINT</span> value, which ranges from -128 to 127, therefore 3 decimal digits are needed to\n        represent the entire range, and because it is an integer value there are no fractional digits. 1.333 is\n        interpreted as a <span class=\"sql-docs-inline-code\">DECIMAL</span> value, with 4 digits total and 3 digits after the decimal point.\n<div class=\"sql-docs-code-block\">[localhost:21000] > select precision(5), scale(5);<br/>+--------------+----------+<br/>| precision(5) | scale(5) |<br/>+--------------+----------+<br/>| 3            | 0        |<br/>+--------------+----------+<br/>[localhost:21000] > select precision(1.333), scale(1.333);<br/>+------------------+--------------+<br/>| precision(1.333) | scale(1.333) |<br/>+------------------+--------------+<br/>| 4                | 3            |<br/>+------------------+--------------+<br/>[localhost:21000] > with t1 as<br/>  ( select cast(12.34 as decimal(20,2)) x union select cast(1 as decimal(8,6)) x )<br/>  select precision(x), scale(x) from t1 limit 1;<br/>+--------------+----------+<br/>| precision(x) | scale(x) |<br/>+--------------+----------+<br/>| 24           | 6        |<br/>+--------------+----------+<br/></div></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_quotient\"><dt><span class=\"sql-docs-inline-code\">quotient(bigint numerator, bigint denominator)</span>,\n          <span class=\"sql-docs-inline-code\">quotient(double numerator, double denominator)</span></dt><dd><b>Purpose:</b> Returns the first argument divided by the second argument, discarding any fractional\n          part. Avoids promoting integer arguments to <span class=\"sql-docs-inline-code\">DOUBLE</span> as happens with the <span class=\"sql-docs-inline-code\">/</span> SQL\n          operator. <span class=\"sql-docs-inline-code\">Also includes an overload that accepts <span class=\"sql-docs-inline-code\">DOUBLE</span> arguments,\n          discards the fractional part of each argument value before dividing, and again returns <span class=\"sql-docs-inline-code\">BIGINT</span>.\n          With integer arguments, this function works the same as the <span class=\"sql-docs-inline-code\">DIV</span> operator.</span><p><b>Return type:</b><span class=\"sql-docs-inline-code\">bigint</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_radians\"><dt><span class=\"sql-docs-inline-code\">radians(double a)</span></dt><dd><b>Purpose:</b> Converts argument value from degrees to radians.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_rand\"><dt><span class=\"sql-docs-inline-code\">rand()</span>, <span class=\"sql-docs-inline-code\">rand(int seed)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_random\" class=\"sql-docs-inline-code\">random()</span>,\n          <span class=\"sql-docs-inline-code\">random(int seed)</span></dt><dd><b>Purpose:</b> Returns a random value between 0 and 1. After <span class=\"sql-docs-inline-code\">rand()</span> is called with a\n          seed argument, it produces a consistent random sequence based on the seed value.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p><p><b>Usage notes:</b> Currently, the random sequence is reset after each query, and multiple calls to\n            <span class=\"sql-docs-inline-code\">rand()</span> within the same query return the same value each time. For different number\n            sequences that are different for each query, pass a unique seed value to each call to\n            <span class=\"sql-docs-inline-code\">rand()</span>. For example, <span class=\"sql-docs-inline-code\">select rand(unix_timestamp()) from ...</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><p>\n            The following examples show how <span class=\"sql-docs-inline-code\">rand()</span> can produce sequences of varying predictability,\n            so that you can reproduce query results involving random values or generate unique sequences of random\n            values for each query.\n            When <span class=\"sql-docs-inline-code\">rand()</span> is called with no argument, it generates the same sequence of values each time,\n            regardless of the ordering of the result set.\n            When <span class=\"sql-docs-inline-code\">rand()</span> is called with a constant integer, it generates a different sequence of values,\n            but still always the same sequence for the same seed value.\n            If you pass in a seed value that changes, such as the return value of the expression <span class=\"sql-docs-inline-code\">unix_timestamp(now())</span>,\n            each query will use a different sequence of random values, potentially more useful in probability calculations although\n            more difficult to reproduce at a later time. Therefore, the final two examples with an unpredictable seed value\n            also include the seed in the result set, to make it possible to reproduce the same random sequence later.\n          </p><div class=\"sql-docs-code-block\">select x, rand() from three_rows;<br/>+---+-----------------------+<br/>| x | rand()                |<br/>+---+-----------------------+<br/>| 1 | 0.0004714746030380365 |<br/>| 2 | 0.5895895192351144    |<br/>| 3 | 0.4431900859080209    |<br/>+---+-----------------------+<br/><br/>select x, rand() from three_rows order by x desc;<br/>+---+-----------------------+<br/>| x | rand()                |<br/>+---+-----------------------+<br/>| 3 | 0.0004714746030380365 |<br/>| 2 | 0.5895895192351144    |<br/>| 1 | 0.4431900859080209    |<br/>+---+-----------------------+<br/><br/>select x, rand(1234) from three_rows order by x;<br/>+---+----------------------+<br/>| x | rand(1234)           |<br/>+---+----------------------+<br/>| 1 | 0.7377511392057646   |<br/>| 2 | 0.009428468537250751 |<br/>| 3 | 0.208117277924026    |<br/>+---+----------------------+<br/><br/>select x, rand(1234) from three_rows order by x desc;<br/>+---+----------------------+<br/>| x | rand(1234)           |<br/>+---+----------------------+<br/>| 3 | 0.7377511392057646   |<br/>| 2 | 0.009428468537250751 |<br/>| 1 | 0.208117277924026    |<br/>+---+----------------------+<br/><br/>select x, unix_timestamp(now()), rand(unix_timestamp(now()))<br/>  from three_rows order by x;<br/>+---+-----------------------+-----------------------------+<br/>| x | unix_timestamp(now()) | rand(unix_timestamp(now())) |<br/>+---+-----------------------+-----------------------------+<br/>| 1 | 1440777752            | 0.002051228658320023        |<br/>| 2 | 1440777752            | 0.5098743483004506          |<br/>| 3 | 1440777752            | 0.9517714925817081          |<br/>+---+-----------------------+-----------------------------+<br/><br/>select x, unix_timestamp(now()), rand(unix_timestamp(now()))<br/>  from three_rows order by x desc;<br/>+---+-----------------------+-----------------------------+<br/>| x | unix_timestamp(now()) | rand(unix_timestamp(now())) |<br/>+---+-----------------------+-----------------------------+<br/>| 3 | 1440777761            | 0.9985985015512437          |<br/>| 2 | 1440777761            | 0.3251255333074953          |<br/>| 1 | 1440777761            | 0.02422675025846192         |<br/>+---+-----------------------+-----------------------------+<br/></div></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_round\"><dt><span class=\"sql-docs-inline-code\">round(double a)</span>,\n          <span class=\"sql-docs-inline-code\">round(double a, int d)</span>,\n          <span class=\"sql-docs-inline-code\">round(decimal a, int_type d)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dround\" class=\"sql-docs-inline-code\">dround(double a)</span>,\n          <span class=\"sql-docs-inline-code\">dround(double a, int d)</span>,\n          <span class=\"sql-docs-inline-code\">dround(decimal(p,s) a, int_type d)</span></dt><dd><b>Purpose:</b> Rounds a floating-point value. By default (with a single argument), rounds to the nearest\n          integer. Values ending in .5 are rounded up for positive numbers, down for negative numbers (that is,\n          away from zero). The optional second argument specifies how many digits to leave after the decimal point;\n          values greater than zero produce a floating-point return value rounded to the requested number of digits\n          to the right of the decimal point.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">bigint</span> for single <span class=\"sql-docs-inline-code\">double</span> argument.\n            <span class=\"sql-docs-inline-code\">double</span> for two-argument signature when second argument greater than zero.\n            For <span class=\"sql-docs-inline-code\">DECIMAL</span> values, the smallest\n            <span class=\"sql-docs-inline-code\">DECIMAL(<span class=\"sql-docs-variable\">p</span>,<span class=\"sql-docs-variable\">s</span>)</span> type with appropriate precision and\n            scale.\n          </p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_scale\"><dt><span class=\"sql-docs-inline-code\">scale(<span class=\"sql-docs-variable\">numeric_expression</span>)</span></dt><dd><b>Purpose:</b> Computes the scale (number of decimal digits to the right of the decimal point) needed to\n          represent the type of the argument expression as a <span class=\"sql-docs-inline-code\">DECIMAL</span> value.\n          <p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p>\n            Typically used in combination with the <span class=\"sql-docs-inline-code\">precision()</span> function, to determine the\n            appropriate <span class=\"sql-docs-inline-code\">DECIMAL(<span class=\"sql-docs-variable\">precision</span>,<span class=\"sql-docs-variable\">scale</span>)</span> type to\n            declare in a <span class=\"sql-docs-inline-code\">CREATE TABLE</span> statement or <span class=\"sql-docs-inline-code\">CAST()</span> function.\n          </p><p><b>Return type:</b><span class=\"sql-docs-inline-code\">int</span></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><p id=\"../Impala/docs/topics/impala_math_functions.xml_precision_scale_example\">\n        The following examples demonstrate how to check the precision and scale of numeric literals or other\n        numeric expressions. Impala represents numeric literals in the smallest appropriate type. 5 is a\n        <span class=\"sql-docs-inline-code\">TINYINT</span> value, which ranges from -128 to 127, therefore 3 decimal digits are needed to\n        represent the entire range, and because it is an integer value there are no fractional digits. 1.333 is\n        interpreted as a <span class=\"sql-docs-inline-code\">DECIMAL</span> value, with 4 digits total and 3 digits after the decimal point.\n<div class=\"sql-docs-code-block\">[localhost:21000] > select precision(5), scale(5);<br/>+--------------+----------+<br/>| precision(5) | scale(5) |<br/>+--------------+----------+<br/>| 3            | 0        |<br/>+--------------+----------+<br/>[localhost:21000] > select precision(1.333), scale(1.333);<br/>+------------------+--------------+<br/>| precision(1.333) | scale(1.333) |<br/>+------------------+--------------+<br/>| 4                | 3            |<br/>+------------------+--------------+<br/>[localhost:21000] > with t1 as<br/>  ( select cast(12.34 as decimal(20,2)) x union select cast(1 as decimal(8,6)) x )<br/>  select precision(x), scale(x) from t1 limit 1;<br/>+--------------+----------+<br/>| precision(x) | scale(x) |<br/>+--------------+----------+<br/>| 24           | 6        |<br/>+--------------+----------+<br/></div></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_sign\"><dt><span class=\"sql-docs-inline-code\">sign(double a)</span></dt><dd><b>Purpose:</b> Returns -1, 0, or 1 to indicate the signedness of the argument value.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">int</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_sin\"><dt><span class=\"sql-docs-inline-code\">sin(double a)</span></dt><dd><b>Purpose:</b> Returns the sine of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_sinh\"><dt><span class=\"sql-docs-inline-code\">sinh(double a)</span></dt><dd><b>Purpose:</b> Returns the hyperbolic sine of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_sqrt\"><dt><span class=\"sql-docs-inline-code\">sqrt(double a)</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dsqrt\" class=\"sql-docs-inline-code\">dsqrt(double a)</span></dt><dd><b>Purpose:</b> Returns the square root of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_tan\"><dt><span class=\"sql-docs-inline-code\">tan(double a)</span></dt><dd><b>Purpose:</b> Returns the tangent of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_tanh\"><dt><span class=\"sql-docs-inline-code\">tanh(double a)</span></dt><dd><b>Purpose:</b> Returns the hyperbolic tangent of the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">double</span></p></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_truncate\"><dt><span class=\"sql-docs-inline-code\">truncate(double_or_decimal a[, digits_to_leave])</span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_dtrunc\" class=\"sql-docs-inline-code\"><span class=\"sql-docs-inline-code\">dtrunc(double_or_decimal a[, digits_to_leave])</span></span>,\n          <span id=\"../Impala/docs/topics/impala_math_functions.xml_trunc_number\" class=\"sql-docs-inline-code\"><span class=\"sql-docs-inline-code\">trunc(double_or_decimal a[, digits_to_leave])</span></span></dt><dd><b>Purpose:</b> Removes some or all fractional digits from a numeric value.\n          <p><b>Arguments:</b>\n            With a single floating-point argument, removes all fractional digits, leaving an\n            integer value. The optional second argument specifies the number of fractional digits\n            to include in the return value, and only applies when the argument type is\n            <span class=\"sql-docs-inline-code\">DECIMAL</span>. A second argument of 0 truncates to a whole integer value.\n            A second argument of negative N sets N digits to 0 on the left side of the decimal\n          </p><p><b>Scale argument:</b> The scale argument applies only when truncating\n            <span class=\"sql-docs-inline-code\">DECIMAL</span> values. It is an integer specifying how many\n            significant digits to leave to the right of the decimal point.\n            A scale argument of 0 truncates to a whole integer value. A scale\n            argument of negative N sets N digits to 0 on the left side of the decimal\n            point.\n          </p><p><span class=\"sql-docs-inline-code\">truncate()</span>, <span class=\"sql-docs-inline-code\">dtrunc()</span>,\n            <span class=\"sql-docs-inline-code\">and <span class=\"sql-docs-inline-code\">trunc()</span></span> are aliases for the\n            same function.\n          </p><p><b>Return type:</b><span class=\"sql-docs-inline-code\">decimal</span> for <span class=\"sql-docs-inline-code\">DECIMAL</span> arguments;\n            <span class=\"sql-docs-inline-code\">bigint</span> for <span class=\"sql-docs-inline-code\">DOUBLE</span> arguments\n          </p><p><b>Added in:</b> The <span class=\"sql-docs-inline-code\">trunc()</span> alias was added in\n            Impala 2.10.\n          </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_usage_notes_blurb\"><b>Usage notes:</b></p><p>\n            You can also pass a <span class=\"sql-docs-inline-code\">DOUBLE</span> argument, or <span class=\"sql-docs-inline-code\">DECIMAL</span>\n            argument with optional scale, to the <span class=\"sql-docs-inline-code\">dtrunc()</span> or\n            <span class=\"sql-docs-inline-code\">truncate</span> functions. Using the <span class=\"sql-docs-inline-code\">trunc()</span>\n            function for numeric values is common with other industry-standard database\n            systems, so you might find such <span class=\"sql-docs-inline-code\">trunc()</span> calls in code that you\n            are porting to Impala.\n          </p><p>\n            The <span class=\"sql-docs-inline-code\">trunc()</span> function also has a signature that applies to\n            <span class=\"sql-docs-inline-code\">TIMESTAMP</span> values. See \n            for details.\n          </p><p id=\"../Impala/docs/topics/impala_math_functions.xml_example_blurb\"><b>Examples:</b></p><p>\n            The following examples demonstrate the <span class=\"sql-docs-inline-code\">truncate()</span>\n            and <span class=\"sql-docs-inline-code\">dtrunc()</span> signatures for this function:\n          </p><div class=\"sql-docs-code-block\">select truncate(3.45);<br/>+----------------+<br/>| truncate(3.45) |<br/>+----------------+<br/>| 3              |<br/>+----------------+<br/><br/>select truncate(-3.45);<br/>+-----------------+<br/>| truncate(-3.45) |<br/>+-----------------+<br/>| -3              |<br/>+-----------------+<br/><br/>select truncate(3.456,1);<br/>+--------------------+<br/>| truncate(3.456, 1) |<br/>+--------------------+<br/>| 3.4                |<br/>+--------------------+<br/><br/>select dtrunc(3.456,1);<br/>+------------------+<br/>| dtrunc(3.456, 1) |<br/>+------------------+<br/>| 3.4              |<br/>+------------------+<br/><br/>select truncate(3.456,2);<br/>+--------------------+<br/>| truncate(3.456, 2) |<br/>+--------------------+<br/>| 3.45               |<br/>+--------------------+<br/><br/>select truncate(3.456,7);<br/>+--------------------+<br/>| truncate(3.456, 7) |<br/>+--------------------+<br/>| 3.4560000          |<br/>+--------------------+<br/></div><p>\n            The following examples demonstrate using <span class=\"sql-docs-inline-code\">trunc()</span> with\n            <span class=\"sql-docs-inline-code\">DECIMAL</span> or <span class=\"sql-docs-inline-code\">DOUBLE</span> values, and with\n            an optional scale argument for <span class=\"sql-docs-inline-code\">DECIMAL</span> values.\n            (The behavior is the same for the <span class=\"sql-docs-inline-code\">truncate()</span> and\n            <span class=\"sql-docs-inline-code\">dtrunc()</span> aliases also.)\n          </p><div class=\"sql-docs-code-block\"><br/>create table t1 (d decimal(20,7));<br/><br/>-- By default, no digits to the right of the decimal point.<br/>insert into t1 values (1.1), (2.22), (3.333), (4.4444), (5.55555);<br/>select trunc(d) from t1 order by d;<br/>+----------+<br/>| trunc(d) |<br/>+----------+<br/>| 1        |<br/>| 2        |<br/>| 3        |<br/>| 4        |<br/>| 5        |<br/>+----------+<br/><br/>-- 1 digit to the right of the decimal point.<br/>select trunc(d,1) from t1 order by d;<br/>+-------------+<br/>| trunc(d, 1) |<br/>+-------------+<br/>| 1.1         |<br/>| 2.2         |<br/>| 3.3         |<br/>| 4.4         |<br/>| 5.5         |<br/>+-------------+<br/><br/>-- 2 digits to the right of the decimal point,<br/>-- including trailing zeroes if needed.<br/>select trunc(d,2) from t1 order by d;<br/>+-------------+<br/>| trunc(d, 2) |<br/>+-------------+<br/>| 1.10        |<br/>| 2.22        |<br/>| 3.33        |<br/>| 4.44        |<br/>| 5.55        |<br/>+-------------+<br/><br/>insert into t1 values (9999.9999), (8888.8888);<br/><br/>-- Negative scale truncates digits to the left<br/>-- of the decimal point.<br/>select trunc(d,-2) from t1 where d > 100 order by d;<br/>+--------------+<br/>| trunc(d, -2) |<br/>+--------------+<br/>| 8800         |<br/>| 9900         |<br/>+--------------+<br/><br/>-- The scale of the result is adjusted to match the<br/>-- scale argument.<br/>select trunc(d,2),<br/>  precision(trunc(d,2)) as p,<br/>  scale(trunc(d,2)) as s<br/>from t1 order by d;<br/>+-------------+----+---+<br/>| trunc(d, 2) | p  | s |<br/>+-------------+----+---+<br/>| 1.10        | 15 | 2 |<br/>| 2.22        | 15 | 2 |<br/>| 3.33        | 15 | 2 |<br/>| 4.44        | 15 | 2 |<br/>| 5.55        | 15 | 2 |<br/>| 8888.88     | 15 | 2 |<br/>| 9999.99     | 15 | 2 |<br/>+-------------+----+---+<br/></div><div class=\"sql-docs-code-block\"><br/>create table dbl (d double);<br/><br/>insert into dbl values<br/>  (1.1), (2.22), (3.333), (4.4444), (5.55555),<br/>  (8888.8888), (9999.9999);<br/><br/>-- With double values, there is no optional scale argument.<br/>select trunc(d) from dbl order by d;<br/>+----------+<br/>| trunc(d) |<br/>+----------+<br/>| 1        |<br/>| 2        |<br/>| 3        |<br/>| 4        |<br/>| 5        |<br/>| 8888     |<br/>| 9999     |<br/>+----------+<br/></div></dd></dlentry><dlentry id=\"../Impala/docs/topics/impala_math_functions.xml_unhex\"><dt><span class=\"sql-docs-inline-code\">unhex(string a)</span></dt><dd><b>Purpose:</b> Returns a string of characters with ASCII values corresponding to pairs of hexadecimal\n          digits in the argument.\n          <p><b>Return type:</b><span class=\"sql-docs-inline-code\">string</span></p></dd></dlentry></dl></div>","title":"Impala Mathematical Functions"}