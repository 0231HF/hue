{"body":"<div><p>\n      Allows multiple <span class=\"sql-docs-inline-code\">COUNT(DISTINCT)</span> operations within a single query, by internally rewriting\n      each <span class=\"sql-docs-inline-code\">COUNT(DISTINCT)</span> to use the <span class=\"sql-docs-inline-code\">NDV()</span> function. The resulting count is\n      approximate rather than precise.\n    </p><p id=\"../Impala/docs/topics/impala_appx_count_distinct.xml_type_boolean\"><b>Type:</b> Boolean; recognized values are 1 and 0, or <span class=\"sql-docs-inline-code\">true</span> and <span class=\"sql-docs-inline-code\">false</span>;\n        any other value interpreted as <span class=\"sql-docs-inline-code\">false</span></p><p id=\"../Impala/docs/topics/impala_appx_count_distinct.xml_default_false_0\"><b>Default:</b><span class=\"sql-docs-inline-code\">false</span> (shown as 0 in output of <span class=\"sql-docs-inline-code\">SET</span> statement)\n      </p><p id=\"../Impala/docs/topics/impala_appx_count_distinct.xml_example_blurb\"><b>Examples:</b></p><p>\n      The following examples show how the <span class=\"sql-docs-inline-code\">APPX_COUNT_DISTINCT</span> lets you work around the restriction\n      where a query can only evaluate <span class=\"sql-docs-inline-code\">COUNT(DISTINCT <span class=\"sql-docs-variable\">col_name</span>)</span> for a single\n      column. By default, you can count the distinct values of one column or another, but not both in a single\n      query:\n    </p><div class=\"sql-docs-code-block\">[localhost:21000] > select count(distinct x) from int_t;<br/>+-------------------+<br/>| count(distinct x) |<br/>+-------------------+<br/>| 10                |<br/>+-------------------+<br/>[localhost:21000] > select count(distinct property) from int_t;<br/>+--------------------------+<br/>| count(distinct property) |<br/>+--------------------------+<br/>| 7                        |<br/>+--------------------------+<br/>[localhost:21000] > select count(distinct x), count(distinct property) from int_t;<br/>ERROR: AnalysisException: all DISTINCT aggregate functions need to have the same set of parameters<br/>as count(DISTINCT x); deviating function: count(DISTINCT property)<br/></div><p>\n      When you enable the <span class=\"sql-docs-inline-code\">APPX_COUNT_DISTINCT</span> query option, now the query with multiple\n      <span class=\"sql-docs-inline-code\">COUNT(DISTINCT)</span> works. The reason this behavior requires a query option is that each\n      <span class=\"sql-docs-inline-code\">COUNT(DISTINCT)</span> is rewritten internally to use the <span class=\"sql-docs-inline-code\">NDV()</span> function instead,\n      which provides an approximate result rather than a precise count.\n    </p><div class=\"sql-docs-code-block\">[localhost:21000] > set APPX_COUNT_DISTINCT=true;<br/>[localhost:21000] > select count(distinct x), count(distinct property) from int_t;<br/>+-------------------+--------------------------+<br/>| count(distinct x) | count(distinct property) |<br/>+-------------------+--------------------------+<br/>| 10                | 7                        |<br/>+-------------------+--------------------------+<br/></div><p id=\"../Impala/docs/topics/impala_appx_count_distinct.xml_related_info\"><b>Related information:</b></p><p><a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_count.xml#count\">COUNT Function</a>,\n      <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_distinct.xml#distinct\">DISTINCT Operator</a>,\n      <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_ndv.xml#ndv\">NDV Function</a></p></div>","title":"APPX_COUNT_DISTINCT Query Option (Impala 2.0 or higher only)"}