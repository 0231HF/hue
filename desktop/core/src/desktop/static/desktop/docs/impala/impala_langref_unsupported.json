{"body":"<div><p>\n      Impala's SQL syntax follows the SQL-92 standard, and includes many industry extensions in areas such as\n      built-in functions. See <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_porting.xml#porting\">Porting SQL from Other Database Systems to Impala</a> for a general discussion of adapting SQL\n      code from a variety of database systems to Impala.\n    </p> <p>\n      Because Impala and Hive share the same metastore database and their tables are often used interchangeably,\n      the following section covers differences between Impala and Hive in detail.\n    </p> </div> <div id=\"../Impala/docs/topics/impala_langref_unsupported.xml_langref_hiveql_unsupported\"><h4>HiveQL Features not Available in Impala</h4> <div><p>\n        The current release of Impala does not support the following SQL features that you might be familiar with\n        from HiveQL:\n      </p> <ul><li>\n          Extensibility mechanisms such as <span class=\"sql-docs-inline-code\">TRANSFORM</span> , custom file formats, or custom SerDes.\n        </li> <li>\n          The <span class=\"sql-docs-inline-code\">DATE</span>  data type.\n        </li> <li>\n          XML and JSON functions.\n        </li> <li>\n          Certain aggregate functions from HiveQL: <span class=\"sql-docs-inline-code\">covar_pop</span> , <span class=\"sql-docs-inline-code\">covar_samp</span> ,\n          <span class=\"sql-docs-inline-code\">corr</span> , <span class=\"sql-docs-inline-code\">percentile</span> , <span class=\"sql-docs-inline-code\">percentile_approx</span> ,\n          <span class=\"sql-docs-inline-code\">histogram_numeric</span> , <span class=\"sql-docs-inline-code\">collect_set</span> ; Impala supports the set of aggregate\n          functions listed in <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_aggregate_functions.xml#aggregate_functions\">Impala Aggregate Functions</a> and analytic\n          functions listed in <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_analytic_functions.xml#analytic_functions\">Impala Analytic Functions</a>.\n        </li> <li>\n          Sampling.\n        </li> <li>\n          Lateral views. In Impala 2.3 and higher, Impala supports queries on complex types\n          (<span class=\"sql-docs-inline-code\">STRUCT</span> , <span class=\"sql-docs-inline-code\">ARRAY</span> , or <span class=\"sql-docs-inline-code\">MAP</span> ), using join notation\n          rather than the <span class=\"sql-docs-inline-code\">EXPLODE()</span>  keyword.\n          See <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_complex_types.xml#complex_types\">Complex Types (Impala 2.3 or higher only)</a> for details about Impala support for complex types.\n        </li> <li>\n          Multiple <span class=\"sql-docs-inline-code\">DISTINCT</span>  clauses per query, although Impala includes some workarounds for this\n          limitation.\n          <div id=\"../Impala/docs/topics/impala_langref_unsupported.xml_multiple_count_distinct\" class=\"sql-docs-note\"><p>\n          By default, Impala only allows a single <span class=\"sql-docs-inline-code\">COUNT(DISTINCT <span class=\"sql-docs-variable\">columns</span> )</span> \n          expression in each query.\n        </p> <p>\n          If you do not need precise accuracy, you can produce an estimate of the distinct values for a column by\n          specifying <span class=\"sql-docs-inline-code\">NDV(<span class=\"sql-docs-variable\">column</span> )</span> ; a query can contain multiple instances of\n          <span class=\"sql-docs-inline-code\">NDV(<span class=\"sql-docs-variable\">column</span> )</span> . To make Impala automatically rewrite\n          <span class=\"sql-docs-inline-code\">COUNT(DISTINCT)</span>  expressions to <span class=\"sql-docs-inline-code\">NDV()</span> , enable the\n          <span class=\"sql-docs-inline-code\">APPX_COUNT_DISTINCT</span>  query option.\n        </p> <p>\n          To produce the same result as multiple <span class=\"sql-docs-inline-code\">COUNT(DISTINCT)</span>  expressions, you can use the\n          following technique for queries involving a single table:\n        </p> <div class=\"sql-docs-code-block\">select v1.c1 result1, v2.c1 result2 from<br/>  (select count(distinct col1) as c1 from t1) v1<br/>    cross join<br/>  (select count(distinct col2) as c1 from t1) v2;<br/></div><p>\n          Because <span class=\"sql-docs-inline-code\">CROSS JOIN</span>  is an expensive operation, prefer to use the <span class=\"sql-docs-inline-code\">NDV()</span> \n          technique wherever practical.\n        </p> </div> </li> </ul> <p>\n        User-defined functions (UDFs) are supported starting in Impala 1.2. See <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_udf.xml#udfs\">Impala User-Defined Functions (UDFs)</a>\n        for full details on Impala UDFs.\n        <ul><li><p>\n              Impala supports high-performance UDFs written in C++, as well as reusing some Java-based Hive UDFs.\n            </p> </li> <li><p>\n              Impala supports scalar UDFs and user-defined aggregate functions (UDAFs). Impala does not currently\n              support user-defined table generating functions (UDTFs).\n            </p> </li> <li><p>\n              Only Impala-supported column types are supported in Java-based UDFs.\n            </p> </li> <li><p id=\"../Impala/docs/topics/impala_langref_unsupported.xml_current_user_caveat\">\n        The Hive <span class=\"sql-docs-inline-code\">current_user()</span>  function cannot be\n        called from a Java UDF through Impala.\n      </p> </li> </ul> </p> <p>\n        Impala does not currently support these HiveQL statements:\n      </p> <ul><li><span class=\"sql-docs-inline-code\">ANALYZE TABLE</span>  (the Impala equivalent is <span class=\"sql-docs-inline-code\">COMPUTE STATS</span> )\n        </li> <li><span class=\"sql-docs-inline-code\">DESCRIBE COLUMN</span> </li> <li><span class=\"sql-docs-inline-code\">DESCRIBE DATABASE</span> </li> <li><span class=\"sql-docs-inline-code\">EXPORT TABLE</span> </li> <li><span class=\"sql-docs-inline-code\">IMPORT TABLE</span> </li> <li><span class=\"sql-docs-inline-code\">SHOW TABLE EXTENDED</span> </li> <li><span class=\"sql-docs-inline-code\">SHOW TBLPROPERTIES</span> </li> <li><span class=\"sql-docs-inline-code\">SHOW INDEXES</span> </li> <li><span class=\"sql-docs-inline-code\">SHOW COLUMNS</span> </li> <li><span class=\"sql-docs-inline-code\">INSERT OVERWRITE DIRECTORY</span> ; use <span class=\"sql-docs-inline-code\">INSERT OVERWRITE <span class=\"sql-docs-variable\">table_name</span> </span> \n          or <span class=\"sql-docs-inline-code\">CREATE TABLE AS SELECT</span>  to materialize query results into the HDFS directory associated\n          with an Impala table.\n        </li> </ul> <p>\n        Impala respects the <span class=\"sql-docs-inline-code\">serialization.null.format</span>  table\n        property only for TEXT tables and ignores the property for Parquet and\n        other formats. Hive respects the <span class=\"sql-docs-inline-code\">serialization.null.format</span> \n        property for Parquet and other formats and converts matching values\n        to NULL during the scan. See  for\n        using the table property in Impala.\n      </p> </div> </div> <div id=\"../Impala/docs/topics/impala_langref_unsupported.xml_langref_hiveql_semantics\"><h4>Semantic Differences Between Impala and HiveQL Features</h4> <div><p>\n        This section covers instances where Impala and Hive have similar functionality, sometimes including the\n        same syntax, but there are differences in the runtime semantics of those features.\n      </p> <p><b>Security:</b> </p> <p>\n        Impala utilizes the  authorization framework, which provides fine-grained role-based access control\n        to protect data against unauthorized access or tampering.\n      </p> <p>\n        The Hive component now includes Sentry-enabled <span class=\"sql-docs-inline-code\">GRANT</span> ,\n        <span class=\"sql-docs-inline-code\">REVOKE</span> , and <span class=\"sql-docs-inline-code\">CREATE/DROP ROLE</span>  statements. Earlier Hive releases had a\n        privilege system with <span class=\"sql-docs-inline-code\">GRANT</span>  and <span class=\"sql-docs-inline-code\">REVOKE</span>  statements that were primarily\n        intended to prevent accidental deletion of data, rather than a security mechanism to protect against\n        malicious users.\n      </p> <p>\n        Impala can make use of privileges set up through Hive <span class=\"sql-docs-inline-code\">GRANT</span>  and <span class=\"sql-docs-inline-code\">REVOKE</span>  statements.\n        Impala has its own <span class=\"sql-docs-inline-code\">GRANT</span>  and <span class=\"sql-docs-inline-code\">REVOKE</span>  statements in Impala 2.0 and higher.\n        See <span>authorization</span> for the details of authorization in Impala, including\n        how to switch from the original policy file-based privilege model to the Sentry service using privileges\n        stored in the metastore database.\n      </p> <p><b>SQL statements and clauses:</b> </p> <p>\n        The semantics of Impala SQL statements varies from HiveQL in some cases where they use similar SQL\n        statement and clause names:\n      </p> <ul><li>\n          Impala uses different syntax and names for query hints, <span class=\"sql-docs-inline-code\">[SHUFFLE]</span>  and\n          <span class=\"sql-docs-inline-code\">[NOSHUFFLE]</span>  rather than <span class=\"sql-docs-inline-code\">MapJoin</span>  or <span class=\"sql-docs-inline-code\">StreamJoin</span> . See\n          <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_joins.xml#joins\">Joins in Impala SELECT Statements</a> for the Impala details.\n        </li> <li>\n          Impala does not expose MapReduce specific features of <span class=\"sql-docs-inline-code\">SORT BY</span> , <span class=\"sql-docs-inline-code\">DISTRIBUTE\n          BY</span> , or <span class=\"sql-docs-inline-code\">CLUSTER BY</span> .\n        </li> <li>\n          Impala does not require queries to include a <span class=\"sql-docs-inline-code\">FROM</span>  clause.\n        </li> </ul> <p><b>Data types:</b> </p> <ul><li>\n          Impala supports a limited set of implicit casts. This can help avoid undesired results from unexpected\n          casting behavior.\n          <ul><li>\n              Impala does not implicitly cast between string and numeric or Boolean types. Always use\n              <span class=\"sql-docs-inline-code\">CAST()</span>  for these conversions.\n            </li> <li>\n              Impala does perform implicit casts among the numeric types, when going from a smaller or less precise\n              type to a larger or more precise one. For example, Impala will implicitly convert a\n              <span class=\"sql-docs-inline-code\">SMALLINT</span>  to a <span class=\"sql-docs-inline-code\">BIGINT</span>  or <span class=\"sql-docs-inline-code\">FLOAT</span> , but to convert from\n              <span class=\"sql-docs-inline-code\">DOUBLE</span>  to <span class=\"sql-docs-inline-code\">FLOAT</span>  or <span class=\"sql-docs-inline-code\">INT</span>  to <span class=\"sql-docs-inline-code\">TINYINT</span> \n              requires a call to <span class=\"sql-docs-inline-code\">CAST()</span>  in the query.\n            </li> <li>\n              Impala does perform implicit casts from string to timestamp. Impala has a restricted set of literal\n              formats for the <span class=\"sql-docs-inline-code\">TIMESTAMP</span>  data type and the <span class=\"sql-docs-inline-code\">from_unixtime()</span>  format\n              string; see <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_timestamp.xml#timestamp\">TIMESTAMP Data Type</a> for details.\n            </li> </ul> <p>\n            See <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_datatypes.xml#datatypes\">Data Types</a> for full details on implicit and explicit casting for\n            all types, and <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_conversion_functions.xml#conversion_functions\">Impala Type Conversion Functions</a> for details about\n            the <span class=\"sql-docs-inline-code\">CAST()</span>  function.\n          </p> </li> <li>\n          Impala does not store or interpret timestamps using the local timezone, to avoid undesired results from\n          unexpected time zone issues. Timestamps are stored and interpreted relative to UTC. This difference can\n          produce different results for some calls to similarly named date/time functions between Impala and Hive.\n          See <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_datetime_functions.xml#datetime_functions\">Impala Date and Time Functions</a> for details about the Impala\n          functions. See <a href=\"javascript: void(0);\" class=\"lang-ref-link\" data-target=\"topics/impala_timestamp.xml#timestamp\">TIMESTAMP Data Type</a> for a discussion of how Impala handles\n          time zones, and configuration options you can use to make Impala match the Hive behavior more closely\n          when dealing with Parquet-encoded <span class=\"sql-docs-inline-code\">TIMESTAMP</span>  data or when converting between\n          the local time zone and UTC.\n        </li> <li>\n          The Impala <span class=\"sql-docs-inline-code\">TIMESTAMP</span>  type can represent dates ranging from 1400-01-01 to 9999-12-31.\n          This is different from the Hive date range, which is 0000-01-01 to 9999-12-31.\n        </li> <li><p id=\"../Impala/docs/topics/impala_langref_unsupported.xml_int_overflow_behavior\">\n        Impala does not return column overflows as <span class=\"sql-docs-inline-code\">NULL</span> , so that customers can distinguish\n        between <span class=\"sql-docs-inline-code\">NULL</span>  data and overflow conditions similar to how they do so with traditional\n        database systems. Impala returns the largest or smallest value in the range for the type. For example,\n        valid values for a <span class=\"sql-docs-inline-code\">tinyint</span>  range from -128 to 127. In Impala, a <span class=\"sql-docs-inline-code\">tinyint</span> \n        with a value of -200 returns -128 rather than <span class=\"sql-docs-inline-code\">NULL</span> . A <span class=\"sql-docs-inline-code\">tinyint</span>  with a\n        value of 200 returns 127.\n      </p> </li> </ul> <p><b>Miscellaneous features:</b> </p> <ul><li>\n          Impala does not provide virtual columns.\n        </li> <li>\n          Impala does not expose locking.\n        </li> <li>\n          Impala does not expose some configuration properties.\n        </li> </ul> </div> </div> ","title":"SQL Differences Between Impala and Hive"}