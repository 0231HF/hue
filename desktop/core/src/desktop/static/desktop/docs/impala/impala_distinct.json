{"body":"<div><p>\n      The <span class=\"sql-docs-inline-code\">DISTINCT</span> operator in a <span class=\"sql-docs-inline-code\">SELECT</span> statement filters the result set to\n      remove duplicates:\n    </p><div class=\"sql-docs-code-block\">-- Returns the unique values from one column.<br/>-- NULL is included in the set of values if any rows have a NULL in this column.<br/>select distinct c_birth_country from customer;<br/>-- Returns the unique combinations of values from multiple columns.<br/>select distinct c_salutation, c_last_name from customer;</div><p>\n      You can use <span class=\"sql-docs-inline-code\">DISTINCT</span> in combination with an aggregation function, typically\n      <span class=\"sql-docs-inline-code\">COUNT()</span>, to find how many different values a column contains:\n    </p><div class=\"sql-docs-code-block\">-- Counts the unique values from one column.<br/>-- NULL is not included as a distinct value in the count.<br/>select count(distinct c_birth_country) from customer;<br/>-- Counts the unique combinations of values from multiple columns.<br/>select count(distinct c_salutation, c_last_name) from customer;</div><p>\n      One construct that Impala SQL does <i>not</i> support is using <span class=\"sql-docs-inline-code\">DISTINCT</span> in more than one\n      aggregation function in the same query. For example, you could not have a single query with both\n      <span class=\"sql-docs-inline-code\">COUNT(DISTINCT c_first_name)</span> and <span class=\"sql-docs-inline-code\">COUNT(DISTINCT c_last_name)</span> in the\n      <span class=\"sql-docs-inline-code\">SELECT</span> list.\n    </p><p id=\"../Impala/docs/topics/impala_distinct.xml_zero_length_strings\"><b>Zero-length strings:</b> For purposes of clauses such as <span class=\"sql-docs-inline-code\">DISTINCT</span> and <span class=\"sql-docs-inline-code\">GROUP\n        BY</span>, Impala considers zero-length strings (<span class=\"sql-docs-inline-code\">\"\"</span>), <span class=\"sql-docs-inline-code\">NULL</span>, and space\n        to all be different values.\n      </p><div id=\"../Impala/docs/topics/impala_distinct.xml_multiple_count_distinct\" class=\"sql-docs-note\"><p>\n          By default, Impala only allows a single <span class=\"sql-docs-inline-code\">COUNT(DISTINCT <span class=\"sql-docs-variable\">columns</span>)</span>\n          expression in each query.\n        </p><p>\n          If you do not need precise accuracy, you can produce an estimate of the distinct values for a column by\n          specifying <span class=\"sql-docs-inline-code\">NDV(<span class=\"sql-docs-variable\">column</span>)</span>; a query can contain multiple instances of\n          <span class=\"sql-docs-inline-code\">NDV(<span class=\"sql-docs-variable\">column</span>)</span>. To make Impala automatically rewrite\n          <span class=\"sql-docs-inline-code\">COUNT(DISTINCT)</span> expressions to <span class=\"sql-docs-inline-code\">NDV()</span>, enable the\n          <span class=\"sql-docs-inline-code\">APPX_COUNT_DISTINCT</span> query option.\n        </p><p>\n          To produce the same result as multiple <span class=\"sql-docs-inline-code\">COUNT(DISTINCT)</span> expressions, you can use the\n          following technique for queries involving a single table:\n        </p><div class=\"sql-docs-code-block\">select v1.c1 result1, v2.c1 result2 from<br/>  (select count(distinct col1) as c1 from t1) v1<br/>    cross join<br/>  (select count(distinct col2) as c1 from t1) v2;<br/></div><p>\n          Because <span class=\"sql-docs-inline-code\">CROSS JOIN</span> is an expensive operation, prefer to use the <span class=\"sql-docs-inline-code\">NDV()</span>\n          technique wherever practical.\n        </p></div><div class=\"sql-docs-note\"><p>\n        In contrast with some database systems that always return <span class=\"sql-docs-inline-code\">DISTINCT</span> values in sorted order,\n        Impala does not do any ordering of <span class=\"sql-docs-inline-code\">DISTINCT</span> values. Always include an <span class=\"sql-docs-inline-code\">ORDER\n        BY</span> clause if you need the values in alphabetical or numeric sorted order.\n      </p></div></div>","title":"DISTINCT Operator"}